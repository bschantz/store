{"version":3,"file":"ngxs-hmr-plugin.js","sources":["../../../../packages/hmr-plugin/src/actions/hmr-init.action.ts","../../../../packages/hmr-plugin/src/actions/hmr-before-destroy.action.ts","../../../../packages/hmr-plugin/src/internal/hmr-state-context-factory.ts","../../../../packages/hmr-plugin/src/internal/hmr-options-builder.ts","../../../../packages/hmr-plugin/src/internal/hmr-lifecycle.ts","../../../../packages/hmr-plugin/src/hmr-manager.ts","../../../../packages/hmr-plugin/src/internal/hmr-storage.ts","../../../../packages/hmr-plugin/src/utils/internals.ts","../../../../packages/hmr-plugin/src/hmr-bootstrap.ts","../../../../packages/hmr-plugin/src/utils/externals.ts"],"sourcesContent":["import { NgxsHmrSnapshot } from '../symbols';\n\nexport class HmrInitAction {\n  static get type() {\n    // NOTE: Not necessary to declare the type in this way in your code. See https://github.com/ngxs/store/pull/644#issuecomment-436003138\n    return '@@HMR_INIT';\n  }\n\n  constructor(public payload: Partial<NgxsHmrSnapshot>) {}\n}\n","import { NgxsHmrSnapshot } from '../symbols';\n\nexport class HmrBeforeDestroyAction {\n  static get type() {\n    // NOTE: Not necessary to declare the type in this way in your code. See https://github.com/ngxs/store/pull/644#issuecomment-436003138\n    return '@@HMR_BEFORE_DESTROY';\n  }\n\n  constructor(public payload: Partial<NgxsHmrSnapshot>) {}\n}\n","import { StateContext, Store } from '@ngxs/store';\nimport { isStateOperator } from '@ngxs/store/operators';\nimport { NgModuleRef } from '@angular/core';\n\nexport class HmrStateContextFactory<T, S> {\n  public store: Store;\n\n  constructor(module: NgModuleRef<T>) {\n    const store = module.injector.get<Store>(Store, undefined);\n\n    if (!store) {\n      throw new Error('Store not found, maybe you forgot to import the NgxsModule');\n    }\n\n    this.store = store;\n  }\n\n  /**\n   * @description\n   * must be taken out into  @ngxs/store/internals\n   */\n  public createStateContext(): StateContext<S> {\n    return {\n      dispatch: actions => this.store!.dispatch(actions),\n      getState: () => <S>this.store!.snapshot(),\n      setState: val => {\n        if (isStateOperator(val)) {\n          const currentState = this.store!.snapshot();\n          val = val(currentState);\n        }\n\n        this.store!.reset(val);\n        return <S>val;\n      },\n      patchState: val => {\n        const currentState = this.store!.snapshot();\n        const newState = { ...currentState, ...(<object>val) };\n        this.store!.reset(newState);\n        return newState;\n      }\n    };\n  }\n}\n","import { NgxsHmrOptions } from '../symbols';\n\nexport class HmrOptionBuilder {\n  public readonly deferTime: number;\n  public readonly autoClearLogs: boolean;\n\n  constructor({ deferTime, autoClearLogs }: NgxsHmrOptions) {\n    this.deferTime = deferTime || 100;\n    this.autoClearLogs = autoClearLogs === undefined ? true : autoClearLogs;\n  }\n\n  public clearLogs(): void {\n    if (this.autoClearLogs) {\n      console.clear();\n    }\n  }\n}\n","import { NgxsBootstrapper } from '@ngxs/store/internals';\nimport { Observable, Subscription } from 'rxjs';\nimport { StateContext } from '@ngxs/store';\n\nimport { HmrOptionBuilder } from './hmr-options-builder';\nimport { HmrCallback, NgxsHmrLifeCycle } from '../symbols';\nimport { HmrStateContextFactory } from './hmr-state-context-factory';\nimport { HmrBeforeDestroyAction } from '../actions/hmr-before-destroy.action';\nimport { HmrStorage } from './hmr-storage';\n\nexport class HmrLifecycle<T extends Partial<NgxsHmrLifeCycle<S>>, S> {\n  constructor(\n    private ngAppModule: T,\n    private bootstrap: NgxsBootstrapper,\n    private storage: HmrStorage<S>,\n    private context: HmrStateContextFactory<T, S>,\n    private options: HmrOptionBuilder\n  ) {}\n\n  public hmrNgxsStoreOnInit(hmrAfterOnInit: HmrCallback<S>) {\n    let moduleHmrInit: HmrCallback<S> = this.getModuleHmrInitCallback();\n    moduleHmrInit = moduleHmrInit.bind(this.ngAppModule);\n    this.detectIvyWithJIT();\n    this.stateEventLoop((ctx, state) => {\n      moduleHmrInit(ctx, state);\n      hmrAfterOnInit(ctx, state);\n    });\n  }\n\n  private getModuleHmrInitCallback(): HmrCallback<S> {\n    if (typeof this.ngAppModule.hmrNgxsStoreOnInit === 'function') {\n      return this.ngAppModule.hmrNgxsStoreOnInit;\n    }\n    return function defaultModuleHmrInit(ctx, state) {\n      ctx.patchState(state);\n    };\n  }\n\n  public hmrNgxsStoreBeforeOnDestroy(): Partial<S> {\n    let state: Partial<S> = {};\n    const ctx: StateContext<S> = this.context.createStateContext();\n    if (typeof this.ngAppModule.hmrNgxsStoreBeforeOnDestroy === 'function') {\n      state = this.ngAppModule.hmrNgxsStoreBeforeOnDestroy(ctx);\n    } else {\n      state = ctx.getState();\n    }\n\n    ctx.dispatch(new HmrBeforeDestroyAction(state));\n    return state;\n  }\n\n  private stateEventLoop(callback: HmrCallback<S>): void {\n    if (!this.storage.hasData()) return;\n\n    const appBootstrapped$: Observable<boolean> = this.bootstrap.appBootstrapped$;\n    const state$: Observable<any> = this.context.store.select(state => state);\n\n    appBootstrapped$.subscribe(() => {\n      let eventId: number;\n      const storeEventId: Subscription = state$.subscribe(() => {\n        // setTimeout used for zone detection after set hmr state\n        clearInterval(eventId);\n        eventId = window.setTimeout(() => {\n          // close check on the message queue\n          storeEventId.unsubscribe();\n          // if events are no longer running on the call stack,\n          // then we can update the state\n          callback(this.context.createStateContext(), this.storage.snapshot as Partial<S>);\n        }, this.options.deferTime);\n      });\n    });\n  }\n\n  private detectIvyWithJIT(): void {\n    const jit: boolean = this.ngAppModule.constructor.hasOwnProperty('__annotations__');\n    const ivy: boolean = this.ngAppModule.constructor.hasOwnProperty('Éµmod');\n    if (jit && ivy) {\n      throw new Error(\n        `@ngxs/hmr-plugin doesn't work with JIT mode in Angular Ivy. Please use AOT mode.`\n      );\n    }\n  }\n}\n","import { ApplicationRef, ComponentRef, NgModuleRef } from '@angular/core';\nimport { InitialState, NgxsBootstrapper } from '@ngxs/store/internals';\n\nimport { HmrStorage } from './internal/hmr-storage';\nimport {\n  BootstrapModuleFn,\n  NgxsHmrLifeCycle,\n  NgxsHmrOptions,\n  NgxsHmrSnapshot\n} from './symbols';\nimport { HmrStateContextFactory } from './internal/hmr-state-context-factory';\nimport { HmrOptionBuilder } from './internal/hmr-options-builder';\nimport { HmrInitAction } from './actions/hmr-init.action';\nimport { HmrLifecycle } from './internal/hmr-lifecycle';\n\ntype OldHostRemoverFn = () => void;\n\nexport class HmrManager<T extends Partial<NgxsHmrLifeCycle<S>>, S = NgxsHmrSnapshot> {\n  public storage: HmrStorage<S>;\n  public context: HmrStateContextFactory<T, S>;\n  public lifecycle: HmrLifecycle<T, S>;\n  public optionsBuilder: HmrOptionBuilder;\n  private ngModule: NgModuleRef<T>;\n\n  constructor(options: NgxsHmrOptions, storage: HmrStorage<S>) {\n    this.storage = storage;\n    this.optionsBuilder = new HmrOptionBuilder(options);\n  }\n\n  private get applicationRef(): ApplicationRef {\n    return this.ngModule.injector.get(ApplicationRef);\n  }\n\n  private get bootstrap(): NgxsBootstrapper {\n    return this.ngModule.injector.get(NgxsBootstrapper);\n  }\n\n  public async hmrModule(\n    bootstrapFn: BootstrapModuleFn<T>,\n    tick: () => void\n  ): Promise<NgModuleRef<T>> {\n    InitialState.set(this.storage.snapshot);\n    this.ngModule = await bootstrapFn();\n    this.context = new HmrStateContextFactory(this.ngModule);\n    this.lifecycle = this.createLifecycle();\n\n    tick();\n\n    InitialState.pop();\n    return this.ngModule;\n  }\n\n  public beforeModuleBootstrap(): void {\n    this.lifecycle.hmrNgxsStoreOnInit((ctx, state) => {\n      ctx.dispatch(new HmrInitAction(state));\n    });\n  }\n\n  public beforeModuleOnDestroy(): Partial<S> {\n    this.optionsBuilder.clearLogs();\n    return this.lifecycle.hmrNgxsStoreBeforeOnDestroy();\n  }\n\n  public createNewModule(): void {\n    const removeOldHosts: () => void = this.cloneHostsBeforeDestroy();\n    this.removeNgStyles();\n    this.ngModule.destroy();\n    removeOldHosts();\n  }\n\n  private createLifecycle(): HmrLifecycle<T, S> {\n    return new HmrLifecycle(\n      this.ngModule.instance,\n      this.bootstrap,\n      this.storage,\n      this.context,\n      this.optionsBuilder\n    );\n  }\n\n  private cloneHostsBeforeDestroy(): () => void {\n    const elements: Element[] = this.applicationRef.components.map(\n      (component: ComponentRef<Element>) => component.location.nativeElement\n    );\n\n    const removableList: OldHostRemoverFn[] = elements.map((componentNode: Element) => {\n      const newNode = document.createElement(componentNode.tagName);\n      const parentNode: Node = componentNode.parentNode as Node;\n      const currentDisplay: string | null = newNode.style.display;\n\n      newNode.style.display = 'none';\n      parentNode.insertBefore(newNode, componentNode);\n\n      return (): void => {\n        newNode.style.display = currentDisplay;\n        try {\n          parentNode.removeChild(componentNode);\n        } catch {}\n      };\n    });\n\n    return function removeOldHosts(): void {\n      removableList.forEach((removeOldHost: OldHostRemoverFn) => removeOldHost());\n    };\n  }\n\n  private removeNgStyles(): void {\n    const head: HTMLHeadElement = document.head!;\n    const styles: HTMLStyleElement[] = Array.from(head!.querySelectorAll('style'));\n\n    styles\n      .filter((style: HTMLStyleElement) => style.innerText.includes('_ng'))\n      .map((style: HTMLStyleElement) => head!.removeChild(style));\n  }\n}\n","export class HmrStorage<S> {\n  constructor(private _snapshot: Partial<S> = {}) {}\n\n  public hasData(): boolean {\n    return Object.keys(this._snapshot).length > 0;\n  }\n\n  public get snapshot(): Partial<S> {\n    return this._snapshot;\n  }\n}\n","import { HmrRuntime } from '../symbols';\n\ndeclare const window: any;\n\nexport function setHmrReloadedTo(value: boolean): void {\n  if (window[HmrRuntime.Status]) {\n    window[HmrRuntime.Status].hmrReloaded = value;\n  }\n}\n\nexport function markApplicationAsHmrReloaded(): void {\n  window[HmrRuntime.Status] = window[HmrRuntime.Status] || {\n    hmrReloaded: false\n  };\n}\n","import { NgModuleRef } from '@angular/core';\nimport { HmrManager } from './hmr-manager';\nimport { BootstrapModuleFn, NgxsHmrOptions, WebpackModule } from './symbols';\nimport { HmrStorage } from './internal/hmr-storage';\nimport { markApplicationAsHmrReloaded, setHmrReloadedTo } from './utils/internals';\n\n/**\n * Hot Module Replacement plugin for NGXS\n * @deprecated As of Angular v10, HMR is no longer supported and will be deprecated.\n * More information [here](https://www.ngxs.io/plugins/hmr).\n */\nexport async function hmr<T>(\n  webpackModule: WebpackModule,\n  bootstrapFn: BootstrapModuleFn<T>,\n  options: NgxsHmrOptions = {}\n): Promise<NgModuleRef<T>> {\n  if (!webpackModule.hot) {\n    console.error('Are you using the --hmr flag for ng serve?');\n    throw new Error('HMR is not enabled for webpack-dev-server!');\n  }\n\n  markApplicationAsHmrReloaded();\n\n  webpackModule.hot.accept();\n\n  interface HmrDataTransfer {\n    snapshot?: any;\n  }\n  const dataTransfer: HmrDataTransfer = webpackModule.hot.data || {};\n\n  const storage = new HmrStorage<any>(dataTransfer.snapshot || {});\n  const manager = new HmrManager<T>(options, storage);\n\n  return await manager.hmrModule(bootstrapFn, () => {\n    manager.beforeModuleBootstrap();\n\n    webpackModule.hot!.dispose((data: HmrDataTransfer) => {\n      setHmrReloadedTo(true);\n      data.snapshot = manager.beforeModuleOnDestroy();\n      manager.createNewModule();\n    });\n  });\n}\n","import { HmrRuntime } from '../symbols';\n\ndeclare const window: any;\n\nexport function hmrIsReloaded(): boolean {\n  return !!(window[HmrRuntime.Status] && window[HmrRuntime.Status].hmrReloaded);\n}\n"],"names":[],"mappings":"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"}